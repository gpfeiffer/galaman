<% competition = @invitation.competition %>

\onecolumn
\thispagestyle{empty}
\begin{minipage}[t]{.5\textwidth}
\section*{<%= competition.name %>}
<%= competition.location %>, <%= competition.dates %>

\section*{Gala Entries}

\subsection*{<%= @invitation.club.name %>}

<% relay_count = @invitation.relays.map { |x| x.entries.count }.sum %>
<% regis_count = @invitation.dockets.map { |x| x.entries.count }.sum %>
<%= @invitation.dockets.count %> registered swimmers
for a total of \\ 
<%= regis_count %> individual
<% if relay_count > 0 %>
events and \\
<%= relay_count %> relay 
<% end %>
events.
\end{minipage}
%
\begin{minipage}[t]{.5\textwidth}
\subsection*{Events.}

\begin{enumerate}
<% competition.events.each do |event| %>
\item[<%= event.pos %>.] 
<%= event.discipline.to_words %>: <%= ages_to_words(event.age_range) %>
<% end %>
\end{enumerate}
\end{minipage}

\subsection*{Registered Swimmers.}

<%= render "swimmers" %>

<% if relay_count > 0 %>
\subsection*{Relay Teams.}
<% events = competition.relay_events %>
\begin{tabular}[t]{p{3cm}cc<%= 'c' * events.count %>}
\toprule
\textbf{Name} & \textbf{F/M} & \textbf{Ages}
    <% events.each do |event| %>
      & <%= ordinal_number (event.pos) -%>
    <% end %> \\
\midrule
  <% @invitation.relays.each do |relay| %>
<%= relay.name %> &
<%= relay.gender.upcase %> &
<%= raw ages_to_tex(relay.age_range) %> 
      <% events.each do |event| %>
	<% entry = Entry.find_by_event_id_and_relay_id(event, relay) %>
	& <%= entry if entry %>
      <% end %>
\\
<% end %>
\bottomrule
\end{tabular}
<% end %>
