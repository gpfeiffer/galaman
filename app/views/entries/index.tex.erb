\onecolumn
\tiny
\tabcolsep2pt
\pagestyle{empty}
\thispagestyle{empty}

\section*{Club Records: <%= @club.full_name %>.}

<% entries_gender = @entries.group_by { |x| x.swimmer.gender } %>
<% Swimmer::GENDERS.each do |gender| %>
\begin{tabular}[t]{|c|<%= "p{1.45cm}|" * Discipline::STROKES.length %>}
\toprule
\textbf{<%= { 'f' => 'Girls', 'm' => 'Boys' }[gender] %>}
<% Discipline::STROKES.each do |stroke| %>
  & {\hfil\textbf{<%= short_stroke_name stroke %>}\hfil}
<% end %>
\\
<% entries_gender[gender].group_by(&:distance_course_code).sort.each do |row, entries_row| %>
\midrule
<% entries = entries_row.group_by(&:stroke) %>
\textbf{<%= distance_course(row) %>}
<% Discipline::STROKES.each do |stroke| %>
& <% if entries[stroke] %>
    <% best = best_result(entries[stroke].map(&:result).compact) %>
    <% if best %>
      {\raggedleft
      <%= best %>\\
      <%= raw best.swimmer.first_last %>\\\hfill
      (<%= best.date %>)}
    <% end %>
  <% end %>
<% end %>
\\
<% end %>
\bottomrule
\end{tabular}
<% end %>

<% @entries.group_by(&:age).sort.each do |age, entries_age| %>
<% entries_gender = entries_age.group_by { |x| x.swimmer.gender } %>
<% Swimmer::GENDERS.each do |gender| %>
<% if entries_gender[gender] %>
\begin{tabular}[t]{|c|<%= "p{1.45cm}|" * Discipline::STROKES.length %>}
\toprule
\textbf{<%= { 'f' => 'Girls', 'm' => 'Boys' }[gender] %> (<%= age %>)}
<% Discipline::STROKES.each do |stroke| %>
  & {\hfil\textbf{<%= short_stroke_name stroke %>}\hfil}
<% end %>
\\
<% entries_gender[gender].group_by(&:distance_course_code).sort.each do |row, entries_row| %>
\midrule
<% entries = entries_row.group_by(&:stroke) %>
\textbf{<%= distance_course(row) %>}
<% Discipline::STROKES.each do |stroke| %>
& <% if entries[stroke] %>
    <% best = best_result(entries[stroke].map(&:result).compact) %>
    <% if best %>
      {\raggedleft
      <%= best %>\\
      <%= raw best.swimmer.first_last %>\\\hfill
      (<%= best.date %>)}
    <% end %>
  <% end %>
<% end %>
\\
<% end %>
\bottomrule
\end{tabular}
\qquad
<% end %>
<% end %>

<% end %>
