\thispagestyle{empty}
\section*{<%= @competition.name %>}
<%= @competition.location %>, <%= @competition.date %>
\section*{Results}

<% Swimmer::GENDERS.each do |sex| %>
  <% events = @competition.individual_events.select { |x| x.gender == sex } %>

\begin{tabular}{p{4cm}<%= 'r' * events.count %>}
    \toprule
    Swimmer, Age
    <% events.each do |event| %>
      & \hbox to 18mm{}\llap{<%= event.discipline.nickname %>}
    <% end %>
    \\ \midrule
<% @invitation.registrations.select { |x| x.gender == sex }.sort_by { |x| x.swimmer.name }.each do |registration| %>
  <% swimmer = registration.swimmer %>
      <%= swimmer.first_last %>, <%= registration.age %>
      <% events.each do |event| %>
	<% entry = registration.entries.where(:event_id => event).first %>
        & 
<% if entry %>
  <%= entry.result if entry %>
  <% qu = entry.result.qualify -%>\rlap{
        <%= '*' if entry.time == 0 or entry.time > entry.result.time %>
        <%= qu and qu[:qualification].name %>}

<% end %>
      <% end %>
      \\
<% end %>
\bottomrule
\end{tabular}
<% end %>
